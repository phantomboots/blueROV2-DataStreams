# BlueROV2 MavLink TCP-out

This python script is designed to fetch MAVLINK messages, which are sensor data stream that are output by the BlueROV2's autopilot board (PixHawk, or Navigator board) and then reformat them for output over a TCP/IP connection that Hypack can more easily interface with.

The BlueOS software that runs on the Raspberry Pi in the BlueROV's subsea can includes a MAVLINK to REST API that repackages the binary MAVLINK data into a format that can be accessed using the REST API. The resulting data are formatted as JSON data.

This scripts leverages the Python requests library, which accesses the JSON data key-value pairs at the https endpoint that is generated by the BlueROV. Using the present BlueOS version (Jun 2022), the endpoint for this data is available at XXX.XXX.XXX.XXX:6040, where the XXX values are the IP address of the Raspberry Pi inside the BlueROV2 subsea can. For the BlueROV2 heavy, this data can be accessed at: 192.168.3.200:6040.

The desired MAVLINK data are retrieved from the IP/port listed above. At present, only the vehicle's heading and depth are retrieved, but additional parameters could be retrieved if needed. Data are retrieved, and depth data are converted from mm to meters. Data are then repackaged as a comma seperated value string formatted as:

$BLUDATA, UTC_Date_Time, Depth, Heading, <CR/LF>

This data is then output via a TCP/IP, and instantiates an instance of a TCP server. The connecting application needs to be configured as a TCP client instance. The IP adress is that of the computer that is running this script, and the port is a user selectable value.
